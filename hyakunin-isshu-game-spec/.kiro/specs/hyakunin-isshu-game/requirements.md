# 要件定義書

## はじめに

百人一首（ひゃくにんいっしゅ）は、日本の伝統的なかるた遊びをブラウザ上で楽しめるWebアプリケーションである。Docker仮想環境を起動することで、ブラウザが開きゲームをプレイできる。読み札（上の句）が読み上げられ、プレイヤーは対応する取り札（下の句）を素早く選択する。

## 用語集

- **Game_System**: 百人一首ゲーム全体を管理するWebアプリケーション
- **Reading_Card（読み札）**: 和歌の全文（上の句＋下の句）が記載されたカード。ゲーム中に順番に提示される
- **Grabbing_Card（取り札）**: 和歌の下の句のみが記載されたカード。プレイヤーが選択する対象
- **Upper_Verse（上の句）**: 和歌の最初の三句（五・七・五）
- **Lower_Verse（下の句）**: 和歌の最後の二句（七・七）
- **Player（プレイヤー）**: ブラウザ上でゲームを操作するユーザー
- **Game_Field（場）**: 取り札が並べられるゲーム画面上の領域
- **Poem_Data（歌データ）**: 百人一首の100首の和歌データ（番号、作者、上の句、下の句）
- **Docker_Container**: ゲームアプリケーションを実行するDocker仮想環境

## 要件

### 要件 1: 歌データの管理

**ユーザーストーリー:** プレイヤーとして、正確な百人一首の歌データでゲームをプレイしたい。正しい和歌と作者情報が表示されることで、学習にも役立てたい。

#### 受け入れ基準

1. THE Game_System SHALL 百人一首の100首すべての歌データ（番号、作者名、上の句、下の句）を保持する
2. WHEN Poem_Data が読み込まれた場合、THE Game_System SHALL 各歌データが番号、作者名、上の句、下の句の4つのフィールドを持つことを検証する
3. WHEN Poem_Data をJSON形式でシリアライズおよびデシリアライズした場合、THE Game_System SHALL 元のデータと同一のオブジェクトを復元する

### 要件 2: ゲームの初期化

**ユーザーストーリー:** プレイヤーとして、ゲームを開始したい。場に取り札が並べられた状態からゲームを始められるようにしたい。

#### 受け入れ基準

1. WHEN プレイヤーがゲーム開始ボタンをクリックした場合、THE Game_System SHALL 100首からランダムに選択した歌の取り札を Game_Field に配置する
2. WHEN ゲームが初期化された場合、THE Game_System SHALL 取り札をランダムな順序で Game_Field に配置する
3. WHEN ゲームが初期化された場合、THE Game_System SHALL スコアを0に設定し、残り札数を表示する

### 要件 3: 読み札の提示

**ユーザーストーリー:** プレイヤーとして、読み札（上の句）を見て対応する取り札を探したい。段階的に上の句が表示されることで、記憶力を試したい。

#### 受け入れ基準

1. WHEN 新しいラウンドが開始された場合、THE Game_System SHALL 現在の読み札の上の句を画面上部に表示する
2. WHEN 上の句が表示された場合、THE Game_System SHALL 作者名も合わせて表示する
3. WHEN 現在のラウンドが終了した場合、THE Game_System SHALL 次の読み札に自動的に進む

### 要件 4: 取り札の選択と判定

**ユーザーストーリー:** プレイヤーとして、正しい取り札をクリックして得点したい。正誤判定が即座に行われることで、テンポよくゲームを進めたい。

#### 受け入れ基準

1. WHEN プレイヤーが正しい取り札をクリックした場合、THE Game_System SHALL その取り札を Game_Field から除去し、スコアを1加算する
2. WHEN プレイヤーが誤った取り札をクリックした場合、THE Game_System SHALL 誤りであることを視覚的にフィードバックし、スコアを変更しない
3. WHEN 取り札が選択された場合、THE Game_System SHALL 正解・不正解を0.5秒以内に判定して表示する
4. WHEN 正しい取り札が選択された場合、THE Game_System SHALL 正解の取り札を緑色でハイライトしてから除去する
5. WHEN 誤った取り札が選択された場合、THE Game_System SHALL 誤りの取り札を赤色で一時的にハイライトする

### 要件 5: スコアと進行管理

**ユーザーストーリー:** プレイヤーとして、自分の成績を確認しながらゲームを進めたい。残り札数やスコアが常に表示されることで、進捗を把握したい。

#### 受け入れ基準

1. WHILE ゲームが進行中の場合、THE Game_System SHALL 現在のスコア、正答率、残り札数を画面上に常時表示する
2. WHEN すべての取り札が除去された場合、THE Game_System SHALL ゲーム終了画面を表示し、最終スコアと正答率を表示する
3. WHEN ゲーム終了画面が表示された場合、THE Game_System SHALL 「もう一度プレイ」ボタンを表示する

### 要件 6: Docker環境での実行

**ユーザーストーリー:** プレイヤーとして、Docker環境を起動するだけでゲームをプレイしたい。複雑なセットアップなしにブラウザでゲームを開始できるようにしたい。

#### 受け入れ基準

1. WHEN Docker_Container が起動された場合、THE Game_System SHALL Webサーバーを起動し、ブラウザからアクセス可能な状態にする
2. THE Game_System SHALL Dockerfile と docker-compose.yml を提供し、`docker compose up` コマンドのみでアプリケーションを起動可能にする
3. WHEN Webサーバーが起動した場合、THE Game_System SHALL ポート8080でHTTPリクエストを受け付ける

### 要件 7: ユーザーインターフェース

**ユーザーストーリー:** プレイヤーとして、和風のデザインで百人一首を楽しみたい。視覚的に美しく、操作しやすいインターフェースでプレイしたい。

#### 受け入れ基準

1. THE Game_System SHALL 和風のデザインテーマ（落ち着いた配色、縦書き対応）を適用する
2. THE Game_System SHALL レスポンシブデザインを採用し、デスクトップおよびタブレットのブラウザで適切に表示する
3. WHEN 取り札が Game_Field に表示された場合、THE Game_System SHALL 各取り札に下の句を縦書きで表示する
4. WHEN プレイヤーが取り札にマウスオーバーした場合、THE Game_System SHALL 視覚的なホバーエフェクトを表示する
